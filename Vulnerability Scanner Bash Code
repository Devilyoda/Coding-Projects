#!/bin/bash

# Ensure the script is run as root
if [[ $EUID -ne 0 ]]; then
    echo "Please run this script as root."
    exit 1
fi

# Update system before scanning
echo "Updating system packages..."
apt update -y && apt upgrade -y

echo "Scanning open ports..."
nmap -sV -p- localhost > open_ports.txt
echo "Open ports saved in open_ports.txt"

echo "Checking for attached USB devices..."
lsusb > usb_devices.txt
echo "Attached USB devices saved in usb_devices.txt"

echo "Listing all open network connections..."
lsof -i > network_connections.txt
echo "Network connections saved in network_connections.txt"

echo "Running rootkit check..."
chkrootkit > rootkit_scan.txt
echo "Rootkit scan results saved in rootkit_scan.txt"

echo "Running Lynis security audit..."
lynis audit system > lynis_report.txt
echo "Lynis security audit saved in lynis_report.txt"

echo "Security scan complete. Check the generated reports for details."
